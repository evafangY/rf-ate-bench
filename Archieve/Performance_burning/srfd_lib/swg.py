def swg_config_fidelity (swg33522B, swg33611A):
    swg33522B.write("*RST")
    swg33611A.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 0.1")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 8.8")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion ARB")
    swg33611A.write("SOURCE1:FUNCtion:ARB:SRATe 400000000")
    swg33611A.write("MMEM:LOAD:DATA \"INT:\\FIDELITY_400MSA.BARB\"")
    swg33611A.write("SOURce1:FUNCtion:ARBitrary \"INT:\\FIDELITY_400MSA.BARB\"")
    swg33611A.write("SOURce1:VOLTage:LEVel:IMMediate:AMPLitude 1")
    swg33611A.write("SOURce1:VOLTage:LEVel:IMMediate:OFFSet 0")
    # swg33611A.write("SOURCE1:BURST:MODE GAT")
    # swg33611A.write("SOURCE1:BURST:STATE ON")
    swg33522B.query("*OPC?")
    swg33611A.query("*OPC?")

def swg_on(swg33522B, swg33611A):
    swg33522B.write("OUTPUT1 ON")
    swg33522B.write("OUTPUT2 ON")
    swg33611A.write("OUTPUT1 ON")

def swg_off(swg33522B, swg33611A):
    swg33611A.write("OUTPUT1 OFF")
    swg33522B.write("OUTPUT1 OFF")
    swg33522B.write("OUTPUT2 OFF") 
    
def swg_config_intermodulation (swg33522B, swg33611A):
    swg33522B.write("*RST")
    swg33611A.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 1")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 0.8")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion SIN")
    swg33611A.write("SOURCE1:FREQUENCY 63885000")
    swg33611A.write("SOURCE1:VOLT:UNIT DBM")
    swg33611A.write("SOURCE1:VOLT -6")
    swg33611A.write("SOURCE1:SUM:INT:FUNC SIN")
    swg33611A.write("SOURCE1:SUM:INT:FREQ 63835000")
    swg33611A.write("SOURCE1:SUM:AMPLITUDE 100")
    swg33611A.write("SOURCE1:SUM:STATE ON")
    swg33522B.query("*OPC?")
    swg33611A.query("*OPC?")

def swg_config_harmonic_output (swg33522B, swg33611A):
    swg33522B.write("*RST")
    swg33611A.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 1")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 0.8")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion SIN")
    swg33611A.write("SOURCE1:FREQUENCY 63860000")
    swg33611A.write("SOURCE1:VOLT:UNIT DBM")
    swg33611A.write("SOURCE1:VOLT 0")
    # swg33611A.write("SOURCE1:BURST:MODE GAT")
    # swg33611A.write("SOURCE1:BURST:STATE ON")
    swg33522B.query("*OPC?")
    swg33611A.query("*OPC?")

def swg_config_single_pulse (swg33522B, swg33611A):
    swg33522B.write("*RST")
    swg33611A.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 1")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 0.8")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion SIN")
    swg33611A.write("SOURCE1:FREQUENCY 63860000")
    swg33611A.write("SOURCE1:VOLT:UNIT DBM")
    swg33611A.write("SOURCE1:VOLT 0")
    # swg33611A.write("SOURCE1:BURST:MODE GAT")
    # swg33611A.write("SOURCE1:BURST:STATE ON")
    swg33522B.query("*OPC?")
    swg33611A.query("*OPC?")

def config_vna (swg33522B):
    swg33522B.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 0.125")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 3.52")
    swg33522B.query("*OPC?")
    
    
def config_noise (swg33522B, swg33611A):
    swg33522B.write("*RST")
    swg33611A.write("*RST")
    swg33522B.write("SOURce1:TRACk INVerted")
    swg33522B.write("OUTPut1:LOAD INFinity")
    swg33522B.write("SOURce1:FUNCtion SQUare")
    swg33522B.write("SOURce1:VOLTage:LOW 0")
    swg33522B.write("SOURce1:VOLTage:HIGH 5")
    swg33522B.write("FUNCTION:SQUARE:PERIOD 1")
    swg33522B.write("SOURce1:FUNCtion:SQUare:DCYCle 6")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion SIN")
    swg33611A.write("SOURCE1:FREQUENCY 63860000")
    swg33611A.write("SOURCE1:VOLT:UNIT DBM")
    swg33611A.write("SOURCE1:VOLT -56")
    # swg33611A.write("SOURCE1:BURST:MODE GAT")
    # swg33611A.write("SOURCE1:BURST:STATE ON")
    swg33522B.query("*OPC?")
    swg33611A.query("*OPC?")
    
def output_cond_setup (swg33611A):
    swg33611A.write("*RST")
    swg33611A.write("OUTPut1:LOAD 50")
    swg33611A.write("SOURce1:FUNCtion SIN")
    swg33611A.write("SOURCE1:FREQUENCY 63860000")
    swg33611A.write("SOURCE1:VOLT:UNIT DBM")
    swg33611A.write("SOURCE1:VOLT 22")
    swg33611A.write("OUTPUT1 ON")
    swg33611A.query("*OPC?")